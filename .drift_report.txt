
> ai-contract-drift-monitor@0.1.0 drift
> tsx src/cli/drift.ts

[metrics] Drift monitor metrics registered
[2025-12-02T17:58:50.256Z] [1b3fb325] [INFO] [drift-check] üöÄ Starting drift check - Run ID: 1b3fb325
[2025-12-02T17:58:50.256Z] [1b3fb325] [INFO] [drift-check] Checking scheduling window...
[2025-12-02T17:58:50.256Z] [1b3fb325] [INFO] [schedule] Schedule check passed - monitoring allowed
[2025-12-02T17:58:50.257Z] [1b3fb325] [INFO] [drift-check] Loading targets from /home/runner/work/ai-contract-drift-monitor/ai-contract-drift-monitor/src/infrastructure/api/config/targets.json
[2025-12-02T17:58:50.257Z] [1b3fb325] [INFO] [drift-check] Loaded 3 target(s)
[2025-12-02T17:58:50.257Z] [1b3fb325] [INFO] [drift-check] Previous snapshot: 3 target(s)
[2025-12-02T17:58:50.257Z] [1b3fb325] [INFO] [drift-check] Fetching fx_usd_eur...
[guardedFetch] GET https://api.frankfurter.app/currencies?from=USD&to=EUR,GBP,JPY (target: fx_usd_eur)
[guardedFetch] Headers: {"User-Agent":"ai-drift-monitor/0.1.0"}
[guardedFetch] ‚úÖ GET https://api.frankfurter.app/currencies?from=USD&to=EUR,GBP,JPY - 200 (741ms)
[2025-12-02T17:58:51.008Z] [1b3fb325] [INFO] [drift-check] ‚úÖ No changes in fx_usd_eur
[2025-12-02T17:58:51.008Z] [1b3fb325] [INFO] [drift-check] Fetching github_repo_ts...
[guardedFetch] GET https://api.github.com/repos/microsoft/TypeScript (target: github_repo_ts)
[guardedFetch] Headers: {"User-Agent":"ai-drift-monitor/0.1.0"}
[guardedFetch] ‚úÖ GET https://api.github.com/repos/microsoft/TypeScript - 200 (130ms)
[2025-12-02T17:58:51.397Z] [1b3fb325] [WARN] [drift-check] Drift detected in github_repo_ts: +2 -2
[2025-12-02T17:58:51.397Z] [1b3fb325] [INFO] [drift-check] Fetching rick_morty_graphql...
[2025-12-02T17:58:51.397Z] [1b3fb325] [INFO] [drift-check] Using GraphQL introspection for rick_morty_graphql
[guardedFetch] POST https://rickandmortyapi.com/graphql (target: rick_morty_graphql)
[guardedFetch] Headers: {"Content-Type":"application/json","User-Agent":"ai-drift-monitor/0.1.0"}
[guardedFetch] ‚úÖ POST https://rickandmortyapi.com/graphql - 200 (160ms)
[2025-12-02T17:58:52.420Z] [1b3fb325] [WARN] [drift-check] Drift detected in rick_morty_graphql: +0 -1
[2025-12-02T17:58:52.421Z] [1b3fb325] [INFO] [drift-check] Classifying severity...
[2025-12-02T17:58:52.421Z] [1b3fb325] [WARN] [drift-check] üö® MAJOR BREAKING CHANGES

  ‚Ä¢ [MAJOR] github_repo_ts: Field 'campo_fake_para_demo' removed (breaking change)
  ‚Ä¢ [MAJOR] github_repo_ts: Field 'outro_campo_inexistente' removed (breaking change)
  ‚Ä¢ [MINOR] github_repo_ts: Field 'description' added (additive change)
  ‚Ä¢ [MINOR] github_repo_ts: Field 'language' added (additive change)
  ‚Ä¢ [MAJOR] rick_morty_graphql: Field 'Character.new_field_teste:string' removed (breaking change)

[2025-12-02T17:58:52.421Z] [1b3fb325] [INFO] [drift-check] Generating AI summary...
[2025-12-02T17:58:52.421Z] [1b3fb325] [INFO] [ai-summary] AI enabled - generating intelligent summary
[2025-12-02T17:58:52.421Z] [1b3fb325] [INFO] [ai-summary] Ground truth tokens extracted: 10 unique tokens
[2025-12-02T17:58:52.422Z] [1b3fb325] [INFO] [ai-summary] Sending request to AI gateway
[2025-12-02T17:58:54.142Z] [1b3fb325] [INFO] [ai-summary] AI summary generated and validated successfully
[2025-12-02T17:58:54.142Z] [1b3fb325] [INFO] [drift-check] Updating snapshot (PR-only mode)...
[2025-12-02T17:58:54.142Z] [1b3fb325] [INFO] [snapshot-update] Updating snapshot: /home/runner/work/ai-contract-drift-monitor/ai-contract-drift-monitor/snapshots/latest.json (mode: PR_ONLY)
[2025-12-02T17:58:54.143Z] [1b3fb325] [INFO] [snapshot-update] ‚úÖ Snapshot written to /home/runner/work/ai-contract-drift-monitor/ai-contract-drift-monitor/snapshots/latest.json
[2025-12-02T17:58:54.143Z] [1b3fb325] [INFO] [snapshot-update] ‚úÖ PR body written to /home/runner/work/ai-contract-drift-monitor/ai-contract-drift-monitor/.pr_body.md
[2025-12-02T17:58:54.144Z] [1b3fb325] [ERROR] [drift-check] üö® BLOCKING: MAJOR changes detected - CI will fail | {}

============================================================
üö® API Drift Detected - MAJOR

üìù Summary:
The API schema has undergone changes, with additions and removals of fields in the github_repo_ts and rick_morty_graphql endpoints, potentially impacting compatibility and data handling for clients. The removal of Character.new_field_teste in rick_morty_graphql is a breaking change, while additions in github_repo_ts may require updates to client handling of description and language fields. These changes have implications for data processing, security, and client compatibility.

üí• Impact:

1. API consumers of github_repo_ts endpoint must update to handle new description and language fields, potentially requiring changes to data parsing and storage logic.

2. Removal of campo_fake_para_demo and outro_campo_inexistente in github_repo_ts may cause issues for clients relying on these fields, despite them being marked as non-existent or for demo purposes.

3. The removal of Character.new_field_teste:string in rick_morty_graphql is a breaking change, requiring clients to update their GraphQL queries to avoid errors.

4. Clients may need to adapt error handling for cases where removed fields are still referenced in queries or payloads, ensuring robustness against potential errors.

‚ö†Ô∏è Risks:

1. Breaking changes in rick_morty_graphql may lead to client errors or failures if not properly updated, potentially impacting user experience and business operations.

2. Incompatible changes could expose security vulnerabilities if not properly handled, such as incorrect data validation or unauthorized access due to outdated client logic.

3. The introduction of new fields like description and language in github_repo_ts may introduce additional attack surfaces if not properly validated and sanitized, posing security risks.

4. Business logic relying on the removed fields may be disrupted, requiring updates to ensure continuity of operations and data integrity.
============================================================

[2025-12-02T17:58:54.144Z] [1b3fb325] [INFO] [drift-check] Teams webhook not configured, skipping
[2025-12-02T17:58:54.144Z] [1b3fb325] [INFO] [drift-check] ‚úÖ Drift check completed in 3888ms - Exit code: 1
